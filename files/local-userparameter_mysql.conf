# https://s2.meissner.it/it/projects/mit-doc/wiki/MySQL-%C3%9Cberwachung_mit_Zabbix
#
# Version 2 of the default mysql scripts from zabbix which
#     1. work
#     2. report 0 if mysql is down and write the error to syslog via logger
# 
# v2015-12-22-1
#
# For all the following commands HOME should be set to the directory that has .my.cnf file with password information.

# Flexible parameter to grab global variables. On the frontend side, use keys like mysql.status2[Com_insert].
# Key syntax is mysql.status2[variable].
UserParameter=mysql.status2[*],/usr/local/bin/zabbix-mysql-status2 $1

# Flexible parameter to determine database or table size. On the frontend side, use keys like mysql.size[zabbix,history,data].
# Key syntax is mysql.size[<database>,<table>,<type>].
# Database may be a database name or "all". Default is "all".
# Table may be a table name or "all". Default is "all".
# Type may be "data", "index", "free" or "both". Both is a sum of data and index. Default is "both".
# Database is mandatory if a table is specified. Type may be specified always.
# Returns value in bytes.
# 'sum' on data_length or index_length alone needed when we are getting this information for whole database instead of a single table
UserParameter=mysql.size2[*],/usr/local/bin/zabbix-mysql-size2 $1 $2 $3

UserParameter=mysql.ping2,HOME=/var/lib/zabbix mysqladmin ping | grep -c alive
UserParameter=mysql.version2,mysql -V

# low level discovery (lld) of databases. HOME is required (tested)
UserParameter=mysql.databases2,HOME=/var/lib/zabbix /usr/local/bin/zabbix-lld-mysql-databases

